@tailwind base;
@tailwind components;
@tailwind utilities;

/* ═══════════════════════════════════════════════════════════════════════
   VARIABLES TIPOGRAPHIQUES FLUIDES
   ═══════════════════════════════════════════════════════════════════════ */

:root {
  /* Desktop (base) */
  --text-xs: 0.75rem;
  /* 12px */
  --text-sm: 0.875rem;
  /* 14px */
  --text-base: 1rem;
  /* 16px */
  --text-lg: 1.125rem;
  /* 18px */
  --text-xl: 1.25rem;
  /* 20px */
  --text-2xl: 1.5rem;
  /* 24px */
  --text-3xl: 1.875rem;
  /* 30px */
  --text-4xl: 2.25rem;
  /* 36px */
  --text-5xl: 3rem;
  /* 48px */
  --text-6xl: 3.75rem;
  /* 60px */
  --text-7xl: 4.5rem;
  /* 72px */
}

/* Mobile : réduction proportionnelle via clamp() */
@media (max-width: 640px) {
  :root {
    /* Réduction de 20-30% selon la taille */
    --text-xs: clamp(0.625rem, 2vw, 0.75rem);
    /* 10-12px */
    --text-sm: clamp(0.75rem, 2.5vw, 0.875rem);
    /* 12-14px */
    --text-base: clamp(0.875rem, 3vw, 1rem);
    /* 14-16px */
    --text-lg: clamp(0.9375rem, 3.5vw, 1.125rem);
    /* 15-18px */
    --text-xl: clamp(1rem, 4vw, 1.25rem);
    /* 16-20px */
    --text-2xl: clamp(1.125rem, 5vw, 1.5rem);
    /* 18-24px */
    --text-3xl: clamp(1.25rem, 6vw, 1.875rem);
    /* 20-30px */
    --text-4xl: clamp(1.5rem, 7vw, 2.25rem);
    /* 24-36px */
    --text-5xl: clamp(1.875rem, 8vw, 3rem);
    /* 30-48px */
    --text-6xl: clamp(2rem, 9vw, 3.75rem);
    /* 32-60px */
    --text-7xl: clamp(2.25rem, 10vw, 4.5rem);
    /* 36-72px */
  }
}

/* Très petits écrans (<375px) */
@media (max-width: 375px) {
  :root {
    --text-5xl: clamp(1.5rem, 8vw, 1.875rem);
    --text-6xl: clamp(1.75rem, 9vw, 2rem);
    --text-7xl: clamp(2rem, 10vw, 2.25rem);
  }
}

/* ═══════════════════════════════════════════════════════════════════════
   UTILITAIRES TAILWIND PERSONNALISÉS
   ═══════════════════════════════════════════════════════════════════════ */

@layer utilities {

  /* Texte fluide qui scale avec la viewport */
  .text-fluid-xs {
    font-size: var(--text-xs);
  }

  .text-fluid-sm {
    font-size: var(--text-sm);
  }

  .text-fluid-base {
    font-size: var(--text-base);
  }

  .text-fluid-lg {
    font-size: var(--text-lg);
  }

  .text-fluid-xl {
    font-size: var(--text-xl);
  }

  .text-fluid-2xl {
    font-size: var(--text-2xl);
  }

  .text-fluid-3xl {
    font-size: var(--text-3xl);
  }

  .text-fluid-4xl {
    font-size: var(--text-4xl);
  }

  .text-fluid-5xl {
    font-size: var(--text-5xl);
  }

  .text-fluid-6xl {
    font-size: var(--text-6xl);
  }

  .text-fluid-7xl {
    font-size: var(--text-7xl);
  }

  /* Force couleur texte sur mobile (correction titres blancs) */
  .text-mobile-dark {
    @apply text-gray-900;
  }

  @media (min-width: 641px) {
    .text-mobile-dark {
      @apply text-inherit;
    }
  }

  /* Touch target minimum 44×44px */
  .touch-target {
    @apply min-h-[44px] min-w-[44px];
  }

  /* Prevent text overflow */
  .text-balance {
    text-wrap: balance;
  }

  .break-words-safe {
    overflow-wrap: break-word;
    word-wrap: break-word;
    hyphens: auto;
  }
}

/* ═══════════════════════════════════════════════════════════════════════
   RESET MOBILE
   ═══════════════════════════════════════════════════════════════════════ */

@layer base {
  html {
    @apply antialiased;
    /* Empêche zoom sur inputs iOS */
    -webkit-text-size-adjust: 100%;
    touch-action: manipulation;
  }

  body {
    @apply overflow-x-hidden;
    background-color: #0A0A0A;
    color: #E0E0E0;
  }

  /* Images responsives par défaut */
  img {
    @apply max-w-full h-auto;
  }

  /* Inputs iOS styling */
  input,
  button,
  select,
  textarea {
    @apply touch-target;
    -webkit-appearance: none;
    appearance: none;
  }
}

/* TipTap Editor Styles (Custom Prose Replacement) */
.prose,
.tiptap {
  color: #e0e0e0;
  line-height: 1.6;
  outline: none !important;
}

.prose h1,
.tiptap h1 {
  font-size: 1.875rem;
  font-weight: 700;
  margin-top: 1.5rem;
  margin-bottom: 1rem;
  color: white;
}

.prose h2,
.tiptap h2 {
  font-size: 1.5rem;
  font-weight: 700;
  margin-top: 1.25rem;
  margin-bottom: 0.75rem;
  color: white;
}

.prose h3,
.tiptap h3 {
  font-size: 1.25rem;
  font-weight: 700;
  margin-top: 1rem;
  margin-bottom: 0.5rem;
  color: white;
}

.prose p,
.tiptap p {
  margin-bottom: 1rem;
}

/* Lists Styles - CRITICAL FIX */
.tiptap ul,
.prose ul:not([data-type="taskList"]) {
  list-style-type: disc !important;
  display: block !important;
  padding-left: 2rem !important;
  margin-top: 1rem !important;
  margin-bottom: 1rem !important;
}

.tiptap ol,
.prose ol {
  list-style-type: decimal !important;
  display: block !important;
  padding-left: 2rem !important;
  margin-top: 1rem !important;
  margin-bottom: 1rem !important;
}

.tiptap li,
.prose li {
  display: list-item !important;
  margin-bottom: 0.25rem !important;
}

.tiptap li p,
.prose li p {
  margin: 0 !important;
  display: inline !important;
}

/* Task List Styles */
.tiptap ul[data-type="taskList"],
.prose ul[data-type="taskList"] {
  list-style: none !important;
  padding: 0 !important;
}

.tiptap ul[data-type="taskList"] li,
.prose ul[data-type="taskList"] li {
  display: flex !important;
  align-items: flex-start !important;
  gap: 0.5rem !important;
  margin-bottom: 0.5rem !important;
}

.tiptap ul[data-type="taskList"] input[type="checkbox"],
.prose ul[data-type="taskList"] input[type="checkbox"] {
  width: 1rem;
  height: 1rem;
  margin-top: 0.25rem;
  cursor: pointer;
  accent-color: #a855f7;
}

/* Links */
.prose a,
.tiptap a {
  color: #a855f7;
  text-decoration: underline;
}

/* Tables in Editor */
.prose table,
.tiptap table {
  border-collapse: collapse;
  width: 100%;
  margin-bottom: 1rem;
}

.prose th,
.prose td,
.tiptap th,
.tiptap td {
  border: 1px solid #374151;
  padding: 0.5rem;
  text-align: left;
}

.prose th,
.tiptap th {
  background-color: #1f2937;
}